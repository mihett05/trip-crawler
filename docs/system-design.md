# Арихитектура системы

## Контекст

Система решает задачу нахождения оптимального пути по наиболее низким ценам при построения маршрута поездки. Для этого необходимо иметь граф поиска и алгоритм построения маршрута.

Ключевые задачи:

- Реализовать алгоритм построения маршрута на основе параметров
- Эффективно парсить информацию для построения графа с учётом ограничений

## Компоненты системы

### Frontend

Клиентская часть состоит из формы для ввода параметров маршрутов и страницы отображения построенного маршрута.

Стек: React, MUI, RTK, RTK Query

### Main Service

Основной сервис, отвечающий за построение маршрута и сохранение информации. Ключевые компоненты:

- Graph - работа с графом информации о доступности поездки различными видами транспорта
- Points - работа со станциями, в основном для подсказок поиска
- Itinerary - работа с алгоритмом построения маршрута

Стек: Go

#### СУБД

Сервис использует ряд СУБД для хранения информации:

- DGraph - графовая СУБД для хранения графа станций и доступности
- Valkey - key-value СУБД для хранения денормализованной информации о станциях

#### Очереди

Сервис использует брокер очередей NATS для отправки задач на парсинг и сохранения результатов парсинга.

#### Планировщик

Планировщик создаёт запросы на парсер достаточно эфективно, чтобы парсер не превышал rate limit у каждого из провайдера. Планировщик запускается через CronJob и по сути собирается как отдельный cli в отдельный контейнер.

### Парсер

Парсер обрабатывает запросы на получение информации об узлах и доступности. На стороне парсера реализованы скраперы разных ресурсов и таблиц для ответа на запрос.

Стек: Go
